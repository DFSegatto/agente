<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Buscar Empresas Privadas</title>
</head>
<body>

<h2>Buscar 20 empresas privadas por cidade</h2>

<input type="text" id="cidade" placeholder="Cidade (ex: JoaÃ§aba)">
<input type="text" id="estado" placeholder="Estado (SC ou Santa Catarina)">
<button onclick="buscarEmpresas()">Buscar</button>

<pre id="resultado"></pre>

<script>
async function buscarEmpresas() {

    const cidade = document.getElementById("cidade").value.trim();
    const estado = document.getElementById("estado").value.trim();
    const resultado = document.getElementById("resultado");

    if (!cidade || !estado) {
        alert("Digite cidade e estado");
        return;
    }

    resultado.textContent = "Buscando empresas privadas...";

    const area = `${cidade}, ${estado}, Brazil`;

    // ðŸ”Ž Consulta Overpass â€” apenas empresas privadas
    const query = `
    [out:json][timeout:25];
    area["name"="${area}"]->.searchArea;

    (
      node["shop"](area.searchArea);
      node["amenity"~"restaurant|cafe|fast_food|pharmacy|clinic|hospital|school|college|university|bar|pub|cinema|theatre|marketplace"](area.searchArea);
      node["office"](area.searchArea);
      node["tourism"="hotel"](area.searchArea);
    );

    // âŒ Excluir bancos e Ã³rgÃ£os pÃºblicos
    foreach -> .a (
      if (!t["amenity"] || t["amenity"] != "bank")
      if (!t["office"] || t["office"] != "government")
      if (!t["government"])
      out tags;
    );
    `;

    try {

        const response = await fetch(
            "https://overpass-api.de/api/interpreter",
            {
                method: "POST",
                body: query
            }
        );

        const data = await response.json();

        const empresas = data.elements
            .filter(e => e.tags && e.tags.name)
            .slice(0, 20);

        if (empresas.length === 0) {
            resultado.textContent = "Nenhuma empresa encontrada.";
            return;
        }

        resultado.textContent = empresas.map(e =>
            `${e.tags.name} â€” ${e.tags.shop || e.tags.amenity || e.tags.office || e.tags.tourism || "empresa"}`
        ).join("\n");

    } catch (erro) {
        resultado.textContent = "Erro ao buscar empresas.";
        console.error(erro);
    }
}
</script>

</body>
</html>
